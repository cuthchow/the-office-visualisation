<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style></style>
    <script type = 'text/javascript' src = 'd3.js'></script>
    <script type = 'text/javascript' src = 'https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.6/d3-legend.js'></script>
    <script type = 'text/javascript' src = 'https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.1.0/chroma.min.js'></script>
    <script type = 'text/javascript' src = 'https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.6/d3-legend.min.js'></script>
    <!-- <script type = 'text/javascript' src = 'script.js'></script> -->
    <link rel="stylesheet" href="style.css">
    <script src = 'script1.js'></script>
    <script src = 'script2.js'></script>
    <script src = 'script3.js'></script>
    <script src = 'script4.js'></script>

</head>
<body>
    <h1>The Office:<br> A Visual Exploration</h1>
    
    <div class = 'commentary'>
        <hr>
        <h2>
            Who is the Smartest Person in The Office?
        </h2>
        <p>
            Ever wondered who the smartest character on "The Office" is? Oscar Martinez was once widely regarded as the smartest
            person in the office, that is, until his position was <a href = 'https://theoffice.fandom.com/wiki/Michael%27s_Botched_Phrases'>'uslurped'</a> by none other than Michael Scott. Michael Scott had bested Oscar
            by demonstrating his wide ranging knowledge of current affairs and the rising urbanisation in China.
            <br><br>
            Despite the heated debate which ensued between the two great minds, the title of 'smartest in the office' remains up for grabs.
            I decided to settle this debate once and for all, by conducting a lexical analysis of all the times the characters spoke on camera,
            and assessing the intellectual level of their speech, using the <a href = 'https://en.wikipedia.org/wiki/Flesch%E2%80%93Kincaid_readability_tests#Flesch%E2%80%93Kincaid_grade_level'>Flesch-Kincaid</a> grade level test. The test roughly equates the complexity
            of their speech to a 'grade-level', and will give use a rough guide as to who speaks with the greatest intellect. 

        </p>
        <button onclick = 'run()' id = 'b1'>
            Reveal Results
        </button>
    </div>

    <svg id = 'radial_bar' width = '1400' height = '1000'></svg>

    <div class = 'commentary'>
        <p>
            Based on this analysis, it seems that David Wallace is in fact the smartest character on The Office. This is not surprising, considering
            after all that this is the man who founded <a href = 'https://www.youtube.com/watch?v=bapk460RPOM'>'Suck It'</a>, and led Dunder Mifflin to some of their most profitable quarters
            <br><br>
            Unfortunately, it seems that Darryl is at the very bottom of this list. I found this quite surprising considering that this is the man
            who brought to us phrases such as 'Dinkin' flicka' and 'going mach five', not to mention the inspiration inducing <a href = 'https://www.youtube.com/watch?v=hyA9sjgIvts'>'pippity poppity, give me the zoppity'.</a>
            <br><br>
            At least one thing is for sure: Michael is DEFINITELY smarter than Oscar. <a href = 'https://www.youtube.com/watch?v=S2XOOESpZg0'>Suck it, Oscar</a>.
            <br><br>
        </p>

        <h2>
            Who is the Most Positive in the Office?
        </h2>
        <p>
            Now we know who the smartest in The Office is, but who brings the most positive energy to the team? We know Michael would probably 
            again consider himself worthy of this title, but would he be correct? To answer this question, I did a similar analysis, but this time
            using a pre-trained language model to build a sentiment classifier, and then use this classifier on all the dialog from each character in 
            the show. 
            <br><br>
            
        </p>
        <div>
            <button onclick = 'sortBySent()' class = 'selected_button' id = 'b2'>By Sentiment</button>
            <button onclick = 'sortByName()' id = 'b3'>By Name</button>
        </div>
        <br><br><br><br>
    </div>

    <svg id = 'sentiment_lines'></svg>

    <div class="commentary">
        <p>
            Glancing at the data, it seems the classifier did a pretty accurate job. Michael, with his botched attempts at humour, and Jim, with his incessant witty quips,
            occupy spots near the tail of the chart. Stanley, the reticent grump, and Angela, the pious accountant, score the very lowest sentiment scores. 
            <br><br>
            What I find particularly interesting is seeing the progression of characters throughout the seasons. Roy had the most dramatic change, starting 
            with the lowest overall score in season 1, and ending up with one of the highest scores in season 9. I guess breaking up with Pam was a <a href = 'https://www.youtube.com/watch?v=mKANXHRUvmk'>good move</a>
             for him as well. It's also nice to see Angela mellow out a little towards the end of the show, with her best years coming at the very end. 
            <br><br>

        </p>

        <h2>Who on "The Office" Spends the Most Time Talking?</h2>
    </div>

    <svg id = 'small_multiples'></svg>

    <div class="commentary">
        <p>
            Glancing at the data, it seems the classifier did a pretty accurate job. Michael, with his botched attempts at humour, and Jim, with his incessant witty quips,
            occupy spots near the tail of the chart. Stanley, the reticent grump, and Angela, the pious accountant, score the very lowest sentiment scores. 
            <br><br>
            What I find particularly interesting is seeing the progression of characters throughout the seasons. Roy had the most dramatic change, starting 
            with the lowest overall score in season 1, and ending up with one of the highest scores in season 9. I guess breaking up with Pam was a <a href = 'https://www.youtube.com/watch?v=mKANXHRUvmk'>good move</a>
             for him as well. It's also nice to see Angela mellow out a little towards the end of the show, with her best years coming at the very end. 
            <br><br>

        </p>

        <h2>Everything</h2>

        <p>
            If all of these charts are making your mind go a mile a minute, I've created a tool to let you explore the lines by yourself.
            Every bubble is an individual spoken line, and each row of bubbles is one episode. The bubbles are also colour coded based 
            on the sentiment score of its contents, and more details can be seen by hovering over the bubbles
        </p>

        <select name="" id="" onChange = 'filterPerson(this.value)'>
            <option value="Everyone">Everyone</option>
            <option value="Michael">Michael</option>
            <option value="Jim">Jim</option>
            <option value="Pam">Pam</option>
            <option value="Dwight">Dwight</option>
            <option value="Darryl">Darryl</option>
            <option value="Stanley">Stanley</option>
            <option value="Phyllis">Phyllis</option>
            <option value="Kevin">Kevin</option>
            <option value="Oscar">Oscar</option>
            <option value="Angela">Angela</option>
            <option value="Andy">Andy</option>
        </select>
        <select name="" id="" onChange = 'filterSeason(this.value)'>
            <option value="1">One</option>
            <option value="2">Two</option>
            <option value="3">Three</option>
            <option value="4">Four</option>
            <option value="5">Five</option>
            <option value="6">Six</option>
            <option value="7">Seven</option>
            <option value="8">Eight</option>
            <option value="9">Nine</option>
        </select>
        <br><br>
    </div>

    <svg id = 'scatterplot'></svg>
    <svg id = 'legend'></svg>

    <div class="commentary">
        <p>
            Glancing at the data, it seems the classifier did a pretty accurate job. Michael, with his botched attempts at humour, and Jim, with his incessant witty quips,
            occupy spots near the tail of the chart. Stanley, the reticent grump, and Angela, the pious accountant, score the very lowest sentiment scores. 
            <br><br>
            What I find particularly interesting is seeing the progression of characters throughout the seasons. Roy had the most dramatic change, starting 
            with the lowest overall score in season 1, and ending up with one of the highest scores in season 9. I guess breaking up with Pam was a <a href = 'https://www.youtube.com/watch?v=mKANXHRUvmk'>good move</a>
             for him as well. It's also nice to see Angela mellow out a little towards the end of the show, with her best years coming at the very end. 
            <br><br>

        </p>

        <h2>Conclusion</h2>

        <p>
            If all of these charts are making your mind go a mile a minute, I've created a tool to let you explore the lines by yourself.
            Every bubble is an individual spoken line, and each row of bubbles is one episode. The larger cluster of bubbles represents
            an entire season of dialog. 
        </p>
        <br><br>
    </div>
    
</body>
</html>